/**
 * Bind instance methods
 * @function abind
 * @param {Object} instance - Instance to bind
 * @param {Object} [options={}] - Optional settings
 * @param {Object} [options.proto=getPrototypeOf(instance)] - Prototype to bind
 * @param {string[]} [options.excludes] - Names to exclude
 * @returns {Object} instance - Bounded instance
 */
'use strict';

/** @lends abind */

var _defineProperty = require('babel-runtime/core-js/object/define-property');

var _defineProperty2 = _interopRequireDefault(_defineProperty);

var _getOwnPropertyDescriptor = require('babel-runtime/core-js/object/get-own-property-descriptor');

var _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);

var _getIterator2 = require('babel-runtime/core-js/get-iterator');

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _getOwnPropertyNames = require('babel-runtime/core-js/object/get-own-property-names');

var _getOwnPropertyNames2 = _interopRequireDefault(_getOwnPropertyNames);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function abind(instance) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var _options$proto = options.proto,
      proto = _options$proto === undefined ? (0, _getPrototypeOf2.default)(instance) : _options$proto,
      _options$excludes = options.excludes,
      excludes = _options$excludes === undefined ? [] : _options$excludes;

  var propertyNames = (0, _getOwnPropertyNames2.default)(proto).filter(function (name) {
    return !~excludes.indexOf(name);
  });
  var _iteratorNormalCompletion = true;
  var _didIteratorError = false;
  var _iteratorError = undefined;

  try {
    for (var _iterator = (0, _getIterator3.default)(propertyNames), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
      var name = _step.value;

      var _ref = _getOwnPropertyDescriptor2.default && (0, _getOwnPropertyDescriptor2.default)(proto, name),
          get = _ref.get,
          set = _ref.set;

      var shouldBind = !/^__/.test(name) && (get || set);
      if (shouldBind) {
        (0, _defineProperty2.default)(instance, name, {
          get: get,
          set: set
        });
        continue;
      }
      var value = proto[name];
      if (typeof value === 'function') {
        instance[name] = value.bind(instance);
      }
    }
  } catch (err) {
    _didIteratorError = true;
    _iteratorError = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion && _iterator.return) {
        _iterator.return();
      }
    } finally {
      if (_didIteratorError) {
        throw _iteratorError;
      }
    }
  }

  return instance;
}

module.exports = abind;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFiaW5kLmpzIl0sIm5hbWVzIjpbImFiaW5kIiwiaW5zdGFuY2UiLCJvcHRpb25zIiwicHJvdG8iLCJleGNsdWRlcyIsInByb3BlcnR5TmFtZXMiLCJmaWx0ZXIiLCJuYW1lIiwiaW5kZXhPZiIsImdldCIsInNldCIsInNob3VsZEJpbmQiLCJ0ZXN0IiwidmFsdWUiLCJiaW5kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztBQVNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQSxTQUFTQSxLQUFULENBQWdCQyxRQUFoQixFQUF3QztBQUFBLE1BQWRDLE9BQWMsdUVBQUosRUFBSTtBQUFBLHVCQUlsQ0EsT0FKa0MsQ0FFcENDLEtBRm9DO0FBQUEsTUFFcENBLEtBRm9DLGtDQUU1Qiw4QkFBc0JGLFFBQXRCLENBRjRCO0FBQUEsMEJBSWxDQyxPQUprQyxDQUdwQ0UsUUFIb0M7QUFBQSxNQUdwQ0EsUUFIb0MscUNBR3pCLEVBSHlCOztBQUt0QyxNQUFJQyxnQkFBZ0IsbUNBQTJCRixLQUEzQixFQUNqQkcsTUFEaUIsQ0FDVixVQUFDQyxJQUFEO0FBQUEsV0FBVSxDQUFDLENBQUNILFNBQVNJLE9BQVQsQ0FBaUJELElBQWpCLENBQVo7QUFBQSxHQURVLENBQXBCO0FBTHNDO0FBQUE7QUFBQTs7QUFBQTtBQU90QyxvREFBaUJGLGFBQWpCLDRHQUFnQztBQUFBLFVBQXZCRSxJQUF1Qjs7QUFBQSxpQkFDWCxzQ0FBbUMsd0NBQWdDSixLQUFoQyxFQUF1Q0ksSUFBdkMsQ0FEeEI7QUFBQSxVQUN4QkUsR0FEd0IsUUFDeEJBLEdBRHdCO0FBQUEsVUFDbkJDLEdBRG1CLFFBQ25CQSxHQURtQjs7QUFFOUIsVUFBSUMsYUFBYSxDQUFDLE1BQU1DLElBQU4sQ0FBV0wsSUFBWCxDQUFELEtBQXNCRSxPQUFPQyxHQUE3QixDQUFqQjtBQUNBLFVBQUlDLFVBQUosRUFBZ0I7QUFDZCxzQ0FBc0JWLFFBQXRCLEVBQWdDTSxJQUFoQyxFQUFzQztBQUNwQ0Usa0JBRG9DO0FBRXBDQztBQUZvQyxTQUF0QztBQUlBO0FBQ0Q7QUFDRCxVQUFJRyxRQUFRVixNQUFPSSxJQUFQLENBQVo7QUFDQSxVQUFJLE9BQU9NLEtBQVAsS0FBaUIsVUFBckIsRUFBaUM7QUFDL0JaLGlCQUFVTSxJQUFWLElBQW1CTSxNQUFNQyxJQUFOLENBQVdiLFFBQVgsQ0FBbkI7QUFDRDtBQUNGO0FBckJxQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQXNCdEMsU0FBT0EsUUFBUDtBQUNEOztBQUVEYyxPQUFPQyxPQUFQLEdBQWlCaEIsS0FBakIiLCJmaWxlIjoiYWJpbmQuanMiLCJzb3VyY2VSb290IjoibGliIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBCaW5kIGluc3RhbmNlIG1ldGhvZHNcbiAqIEBmdW5jdGlvbiBhYmluZFxuICogQHBhcmFtIHtPYmplY3R9IGluc3RhbmNlIC0gSW5zdGFuY2UgdG8gYmluZFxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zPXt9XSAtIE9wdGlvbmFsIHNldHRpbmdzXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucHJvdG89Z2V0UHJvdG90eXBlT2YoaW5zdGFuY2UpXSAtIFByb3RvdHlwZSB0byBiaW5kXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBbb3B0aW9ucy5leGNsdWRlc10gLSBOYW1lcyB0byBleGNsdWRlXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBpbnN0YW5jZSAtIEJvdW5kZWQgaW5zdGFuY2VcbiAqL1xuJ3VzZSBzdHJpY3QnXG5cbi8qKiBAbGVuZHMgYWJpbmQgKi9cbmZ1bmN0aW9uIGFiaW5kIChpbnN0YW5jZSwgb3B0aW9ucyA9IHt9KSB7XG4gIGxldCB7XG4gICAgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5zdGFuY2UpLFxuICAgIGV4Y2x1ZGVzID0gW11cbiAgfSA9IG9wdGlvbnNcbiAgbGV0IHByb3BlcnR5TmFtZXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhwcm90bylcbiAgICAuZmlsdGVyKChuYW1lKSA9PiAhfmV4Y2x1ZGVzLmluZGV4T2YobmFtZSkpXG4gIGZvciAobGV0IG5hbWUgb2YgcHJvcGVydHlOYW1lcykge1xuICAgIGxldCB7IGdldCwgc2V0IH0gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sIG5hbWUpXG4gICAgbGV0IHNob3VsZEJpbmQgPSAhL15fXy8udGVzdChuYW1lKSAmJiAoZ2V0IHx8IHNldClcbiAgICBpZiAoc2hvdWxkQmluZCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGluc3RhbmNlLCBuYW1lLCB7XG4gICAgICAgIGdldCxcbiAgICAgICAgc2V0XG4gICAgICB9KVxuICAgICAgY29udGludWVcbiAgICB9XG4gICAgbGV0IHZhbHVlID0gcHJvdG9bIG5hbWUgXVxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGluc3RhbmNlWyBuYW1lIF0gPSB2YWx1ZS5iaW5kKGluc3RhbmNlKVxuICAgIH1cbiAgfVxuICByZXR1cm4gaW5zdGFuY2Vcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhYmluZFxuIl19